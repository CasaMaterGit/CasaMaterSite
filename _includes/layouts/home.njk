---
layout: layouts/base.njk
---

<!-- ===== SLIDER ===== -->
<section class="hero-slider">
  <div class="slider-container">
    <button class="arrow left">‹</button>
    <button class="arrow right">›</button>
    <div class="dots"></div>

    <div class="slider-track">
      {% for slide in slides %}
      <div class="slide">
        <img src="{{ slide.image | replace('/public', '') }}" alt="{{ slide.title }}" eleventy:ignore>
        <h1 class="hero-title">{{ slide.title }}</h1>
        <h2 class="hero-subtitle">{{ slide.subtitle }}</h2>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- ===== ATUACIÓN ===== -->
<section class="home-section section-white reveal">
  <div class="container">
    <h2 class="section-title-ac">{{ actuacion_title }}</h2>
    <p class="p-actuacion">{{ actuacion_text }}</p>

    <div class="actuacion-grid">
      {% for item in actuacion %}
      <div class="actuacion-item">
        <div class="icon-circle">
          <img src="{{ item.icon | replace('/public', '') }}" alt="{{ item.title }}" eleventy:ignore>
        </div>
        <h3>{{ item.title }}</h3>
      </div>
      {% endfor %}
    </div>

    <div class="actuacion-button">
      <a href="/servicos" class="btn-primary">¿Desea saber más?</a>
    </div>
  </div>
</section>

<!-- ===== VISIÓN ===== -->
<section class="home-section section-vision reveal">
  <div class="vision-panel">
    <div class="vision-overlay">
      <h2 class="section-title">{{ vision_title }}</h2>
      <p class="vision-text">{{ vision_text }}</p>
    </div>
  </div>
</section>

<!-- ===== TESTIMONIOS ===== -->
<section class="home-section section-white reveal">
  <div class="container">
    <h2 class="section-title">Experiencias</h2>

    <div class="testimonials">
      {% for t in testimonials %}
      <article class="testimonial">
        <h3>{{ t.name }}</h3>
        <p>{{ t.text }}</p>
        <button class="read-more">
          Leer más <span>▾</span>
        </button>
      </article>
      {% endfor %}
    </div>
  </div>
</section>

<!-- ===== GALERIA ===== -->
<section class="home-section section-white reveal">
  <div class="container">
    <div class="gallery-slider">
      <button class="gallery-arrow left">‹</button>

      <div class="gallery-viewport">
        <div class="gallery-track">
          {% for g in gallery %}
          <div class="gallery-item">
            <img src="{{ g.image | replace('/public', '') }}" alt="Galería" eleventy:ignore>
          </div>
          {% endfor %}
        </div>
      </div>

      <button class="gallery-arrow right">›</button>
    </div>
  </div>
</section>

<section id="colaboradores" class="home-section section-white reveal">

  <h2 class="section-title">{{ colaboradoras_title }}</h2>

  <div class="partners-grid">
    {% for partner in colaboradoras %}
      <div class="partner-item">
        <a href="{{ partner.link }}" target="_blank" rel="noopener">
          <div class="partner-circle">
            <img 
              src="{{ partner.image | replace('public/', '/') }}" 
              alt="{{ partner.name }}" 
              eleventy:ignore
            >
          </div>
          <h3 class="partner-name">{{ partner.name }}</h3>
        </a>
      </div>
    {% endfor %}
  </div>

</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const track = document.querySelector('.slider-track');
  if (!track) return;

  let slides = Array.from(track.children);
  const dotsContainer = document.querySelector('.dots');
  const prev = document.querySelector('.arrow.left');
  const next = document.querySelector('.arrow.right');

  let current = 0;
  let visible = window.innerWidth <= 768 ? 1 : 3;

  function setSlideWidths() {
    visible = window.innerWidth <= 768 ? 1 : 3;
    const slideWidthPercent = 100 / visible;
    slides.forEach(slide => {
      slide.style.width = `${slideWidthPercent}%`;
    });
    updateSlider(false);
  }

  function createDots() {
    if (!dotsContainer) return;
    dotsContainer.innerHTML = '';
    slides.forEach((_, i) => {
      const dot = document.createElement('button');
      dot.className = 'dot';
      dot.onclick = () => {
        current = i;
        updateSlider();
      };
      dotsContainer.appendChild(dot);
    });
  }

  function updateSlider(animate = true) {
    const slideWidth = slides[0].offsetWidth; // largura real em pixels
    track.style.transition = animate ? 'transform 0.5s ease' : 'none';
    track.style.transform = `translateX(-${current * slideWidth}px)`;

    document.querySelectorAll('.dot').forEach((d, i) => {
      d.classList.toggle('active', i === current);
    });
  }

  next?.addEventListener('click', () => {
    current = (current + 1) % slides.length;
    updateSlider();
  });

  prev?.addEventListener('click', () => {
    current = (current - 1 + slides.length) % slides.length;
    updateSlider();
  });

  window.addEventListener('resize', () => {
    setSlideWidths();
    slides = Array.from(track.children); // atualiza referência
  });

  // inicializa
  setSlideWidths();
  createDots();
  updateSlider(false);
});
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll('.testimonial').forEach(card => {
    const text = card.querySelector('p');
    const button = card.querySelector('.read-more');

    if (!button) return;

    /* só mostra o botão se o texto for maior */
    if (text.scrollHeight <= text.clientHeight + 5) {
      button.style.display = 'none';
      return;
    }

    button.addEventListener('click', () => {
      card.classList.toggle('open');

      button.innerHTML = card.classList.contains('open')
        ? 'Leer menos <span>▾</span>'
        : 'Leer más <span>▾</span>';
    });
  });
});
</script>
